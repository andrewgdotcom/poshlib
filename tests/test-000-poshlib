#!/bin/bash
SCRIPT_DIR=$(dirname "${BASH_SOURCE[0]}")
. $SCRIPT_DIR/../poshlib.sh || exit 1

### detect_shell ###

if [ "$__posh__detected__shell" != "bash" ]; then
	echo "Shell not detected, expected 'bash' got '$output'"
	exit 1
fi

### prependpath ###

tmpfile=$(mktemp)
tmpdir=$(dirname $tmpfile)

cat <<EOF >$tmpfile
#!/bin/bash
. $SCRIPT_DIR/../poshlib.sh || exit 1

path=a
path=\$(__posh__prependpath \$path ../b)
path=\$(__posh__prependpath \$path ./c)
path=\$(__posh__prependpath \$path /d)
echo \$path
EOF

path=$(/bin/bash $tmpfile)
if [ "$path" != "/d:$tmpdir/c:$tmpdir/../b:a" ]; then
	echo "Path prepending not working: path = $path"
	exit 1
fi

